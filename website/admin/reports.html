<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Reports â€” Hunter Auto</title>
  <style>html{visibility:hidden}html.page-ready{visibility:visible}</style>
  <link rel="preload" href="styles-clean.css" as="style" onload="this.rel='stylesheet';document.documentElement.classList.add('page-ready')">
  <noscript><link rel="stylesheet" href="styles-clean.css"></noscript>
    <script>
      // Apply dark mode immediately to prevent flash
      if (localStorage.getItem('appSettings')) {
        const settings = JSON.parse(localStorage.getItem('appSettings'));
        if (settings.darkMode) {
          document.addEventListener('DOMContentLoaded', function() {
            document.body.classList.add('dark-mode');
          });
        }
      }
    </script>
  </head>
  <body>
    <div class="app-shell">
      <aside class="sidebar" role="navigation">
        <div class="brand"><div style="font-weight:900">Hunter Auto</div><div class="small">Admin</div></div>
        <nav class="nav">
          <a href="dashboard.html">Dashboard</a>
          <a href="documents.html">Documents</a>
          <a href="invoices.html">Invoices</a>
          <a href="clients.html">Clients</a>
          <a href="services.html">Services</a>
          <a href="reports.html" class="active">Reports</a>
          <a href="settings.html">Settings</a>
        </nav>
      </aside>

      <main class="main-area">
        <header class="topbar">
          <div class="left">
            <button id="hamburger" class="hamburger" aria-label="Open menu" aria-expanded="false">â˜°</button>
            <h1>Reports</h1>
          </div>
        </header>
        
        <div class="container" style="padding: 24px; max-width: 1600px; width: 100%;">
          <h2 style="font-size: 1.75rem; font-weight: 800; background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 24px;">
            ðŸ“Š Business Analytics & Reports
          </h2>
          
          <!-- Report Type Cards -->
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; margin-bottom: 32px;">
            <div class="card report-type-card" onclick="generateReport('revenue')" style="padding: 24px; cursor: pointer; transition: var(--transition-base); border-left: 4px solid var(--primary);"
              onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='var(--shadow-xl)'"
              onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='var(--shadow-md)'">
              <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 12px;">
                <div style="width: 48px; height: 48px; background: var(--gradient-primary); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px;">
                  ðŸ’°
                </div>
                <div>
                  <h3 style="font-size: 1.125rem; font-weight: 700; margin: 0;">Revenue Report</h3>
                  <p style="font-size: 0.875rem; color: var(--text-secondary); margin: 4px 0 0 0;">Income & payment tracking</p>
                </div>
              </div>
              <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 12px; border-top: 1px solid var(--border);">
                <span style="font-size: 0.75rem; color: var(--text-secondary);">Last updated: Today</span>
                <button style="padding: 6px 12px; background: var(--primary-50); color: var(--primary); border: none; border-radius: 6px; font-size: 0.75rem; font-weight: 600; cursor: pointer;">
                  Generate â†’
                </button>
              </div>
            </div>
            
            <div class="card report-type-card" onclick="generateReport('clients')" style="padding: 24px; cursor: pointer; transition: var(--transition-base); border-left: 4px solid var(--accent-purple);"
              onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='var(--shadow-xl)'"
              onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='var(--shadow-md)'">
              <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 12px;">
                <div style="width: 48px; height: 48px; background: var(--gradient-purple); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px;">
                  ðŸ‘¥
                </div>
                <div>
                  <h3 style="font-size: 1.125rem; font-weight: 700; margin: 0;">Client Report</h3>
                  <p style="font-size: 0.875rem; color: var(--text-secondary); margin: 4px 0 0 0;">Customer insights & history</p>
                </div>
              </div>
              <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 12px; border-top: 1px solid var(--border);">
                <span style="font-size: 0.75rem; color: var(--text-secondary);">Last updated: Today</span>
                <button style="padding: 6px 12px; background: rgba(139, 92, 246, 0.1); color: var(--accent-purple); border: none; border-radius: 6px; font-size: 0.75rem; font-weight: 600; cursor: pointer;">
                  Generate â†’
                </button>
              </div>
            </div>
            
            <div class="card report-type-card" onclick="generateReport('services')" style="padding: 24px; cursor: pointer; transition: var(--transition-base); border-left: 4px solid var(--success);"
              onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='var(--shadow-xl)'"
              onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='var(--shadow-md)'">
              <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 12px;">
                <div style="width: 48px; height: 48px; background: var(--gradient-success); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px;">
                  ðŸ”§
                </div>
                <div>
                  <h3 style="font-size: 1.125rem; font-weight: 700; margin: 0;">Services Report</h3>
                  <p style="font-size: 0.875rem; color: var(--text-secondary); margin: 4px 0 0 0;">Popular services & trends</p>
                </div>
              </div>
              <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 12px; border-top: 1px solid var(--border);">
                <span style="font-size: 0.75rem; color: var(--text-secondary);">Last updated: Today</span>
                <button style="padding: 6px 12px; background: var(--success-light); color: var(--success); border: none; border-radius: 6px; font-size: 0.75rem; font-weight: 600; cursor: pointer;">
                  Generate â†’
                </button>
              </div>
            </div>
            
            <div class="card report-type-card" onclick="generateReport('inventory')" style="padding: 24px; cursor: pointer; transition: var(--transition-base); border-left: 4px solid var(--warning);"
              onmouseover="this.style.transform='translateY(-4px)'; this.style.boxShadow='var(--shadow-xl)'"
              onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='var(--shadow-md)'">
              <div style="display: flex; align-items: center; gap: 16px; margin-bottom: 12px;">
                <div style="width: 48px; height: 48px; background: var(--gradient-warning); border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px;">
                  ðŸ“¦
                </div>
                <div>
                  <h3 style="font-size: 1.125rem; font-weight: 700; margin: 0;">Inventory Report</h3>
                  <p style="font-size: 0.875rem; color: var(--text-secondary); margin: 4px 0 0 0;">Stock levels & usage</p>
                </div>
              </div>
              <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 12px; border-top: 1px solid var(--border);">
                <span style="font-size: 0.75rem; color: var(--text-secondary);">Last updated: Today</span>
                <button style="padding: 6px 12px; background: var(--warning-light); color: var(--warning); border: none; border-radius: 6px; font-size: 0.75rem; font-weight: 600; cursor: pointer;">
                  Generate â†’
                </button>
              </div>
            </div>
          </div>
          
          <!-- Date Range & Export Section -->
          <div class="card" style="padding: 24px; margin-bottom: 24px;">
            <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
              ðŸ“… Custom Date Range
            </h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px; margin-bottom: 20px;">
              <div>
                <label style="display: block; font-size: 0.875rem; font-weight: 600; color: var(--text-secondary); margin-bottom: 6px;">Start Date</label>
                <input type="date" id="startDate" style="width: 100%; padding: 10px 12px; border: 2px solid var(--border); border-radius: 8px; font-size: 0.875rem; transition: var(--transition-base);"
                  onfocus="this.style.borderColor='var(--primary)'; this.style.boxShadow='0 0 0 3px rgba(0,178,255,0.1)'"
                  onblur="this.style.borderColor='var(--border)'; this.style.boxShadow='none'" />
              </div>
              
              <div>
                <label style="display: block; font-size: 0.875rem; font-weight: 600; color: var(--text-secondary); margin-bottom: 6px;">End Date</label>
                <input type="date" id="endDate" style="width: 100%; padding: 10px 12px; border: 2px solid var(--border); border-radius: 8px; font-size: 0.875rem; transition: var(--transition-base);"
                  onfocus="this.style.borderColor='var(--primary)'; this.style.boxShadow='0 0 0 3px rgba(0,178,255,0.1)'"
                  onblur="this.style.borderColor='var(--border)'; this.style.boxShadow='none'" />
              </div>
              
              <div style="display: flex; gap: 8px; align-items: flex-end;">
                <button onclick="applyDateRange()" style="flex: 1; padding: 10px 16px; background: var(--gradient-primary); color: white; border: none; border-radius: 8px; font-weight: 600; font-size: 0.875rem; cursor: pointer; transition: var(--transition-base);"
                  onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='var(--shadow-md)'"
                  onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                  Apply Range
                </button>
              </div>
            </div>
            
            <div style="display: flex; gap: 8px; flex-wrap: wrap;">
              <button onclick="setQuickRange('today')" class="quick-range-btn">Today</button>
              <button onclick="setQuickRange('week')" class="quick-range-btn">This Week</button>
              <button onclick="setQuickRange('month')" class="quick-range-btn">This Month</button>
              <button onclick="setQuickRange('quarter')" class="quick-range-btn">This Quarter</button>
              <button onclick="setQuickRange('year')" class="quick-range-btn">This Year</button>
            </div>
          </div>
          
          <!-- Export Options -->
          <div class="card" style="padding: 24px;">
            <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 20px; display: flex; align-items: center; gap: 8px;">
              ðŸ“¤ Export Reports
            </h3>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px;">
              <button onclick="exportReport('pdf')" style="padding: 16px; background: white; border: 2px solid var(--border); border-radius: 12px; cursor: pointer; transition: var(--transition-base); display: flex; align-items: center; gap: 12px;"
                onmouseover="this.style.borderColor='var(--danger)'; this.style.transform='translateY(-2px)'; this.style.boxShadow='var(--shadow-md)'"
                onmouseout="this.style.borderColor='var(--border)'; this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                <div style="width: 40px; height: 40px; background: linear-gradient(135deg, #dc2626, #ef4444); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 20px; color: white;">
                  ðŸ“„
                </div>
                <div style="text-align: left;">
                  <div style="font-weight: 700; font-size: 1rem;">Export as PDF</div>
                  <div style="font-size: 0.75rem; color: var(--text-secondary);">Printable format</div>
                </div>
              </button>
              
              <button onclick="exportReport('excel')" style="padding: 16px; background: white; border: 2px solid var(--border); border-radius: 12px; cursor: pointer; transition: var(--transition-base); display: flex; align-items: center; gap: 12px;"
                onmouseover="this.style.borderColor='var(--success)'; this.style.transform='translateY(-2px)'; this.style.boxShadow='var(--shadow-md)'"
                onmouseout="this.style.borderColor='var(--border)'; this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                <div style="width: 40px; height: 40px; background: var(--gradient-success); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 20px; color: white;">
                  ðŸ“Š
                </div>
                <div style="text-align: left;">
                  <div style="font-weight: 700; font-size: 1rem;">Export as Excel</div>
                  <div style="font-size: 0.75rem; color: var(--text-secondary);">Spreadsheet format</div>
                </div>
              </button>
              
              <button onclick="exportReport('csv')" style="padding: 16px; background: white; border: 2px solid var(--border); border-radius: 12px; cursor: pointer; transition: var(--transition-base); display: flex; align-items: center; gap: 12px;"
                onmouseover="this.style.borderColor='var(--primary)'; this.style.transform='translateY(-2px)'; this.style.boxShadow='var(--shadow-md)'"
                onmouseout="this.style.borderColor='var(--border)'; this.style.transform='translateY(0)'; this.style.boxShadow='none'">
                <div style="width: 40px; height: 40px; background: var(--gradient-primary); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 20px; color: white;">
                  ðŸ“‹
                </div>
                <div style="text-align: left;">
                  <div style="font-weight: 700; font-size: 1rem;">Export as CSV</div>
                  <div style="font-size: 0.75rem; color: var(--text-secondary);">Data format</div>
                </div>
              </button>
            </div>
          </div>
          
          <!-- Report Preview Area -->
          <div id="reports-metrics" class="card" style="padding: 24px; margin-top: 24px; min-height: 300px; display: none;">
            <h3 style="font-size: 1.25rem; font-weight: 700; margin-bottom: 20px;">Report Preview</h3>
            <div id="report-content" style="color: var(--text-secondary); text-align: center; padding: 60px 20px;">
              <div style="font-size: 3rem; margin-bottom: 16px;">ðŸ“ˆ</div>
              <div style="font-size: 1.125rem; font-weight: 600; margin-bottom: 8px;">No report generated yet</div>
              <div style="font-size: 0.875rem;">Select a report type above to view analytics</div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Mobile Overlay -->
    <div id="mobileOverlay" class="mobile-overlay"></div>

    <script src="admin.js"></script>
    <script>
      // Report generation and date range functions
      let currentReportType = null;
      
      document.addEventListener('DOMContentLoaded', () => {
        // Set default date range to current month
        const today = new Date();
        const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);
        document.getElementById('endDate').valueAsDate = today;
        document.getElementById('startDate').valueAsDate = firstDay;
      });
      
      function generateReport(type) {
        currentReportType = type;
        const previewArea = document.getElementById('reports-metrics');
        const contentArea = document.getElementById('report-content');
        
        previewArea.style.display = 'block';
        
        // Get data based on report type
        let reportData = {};
        
        switch(type) {
          case 'revenue':
            reportData = generateRevenueReport();
            break;
          case 'clients':
            reportData = generateClientsReport();
            break;
          case 'services':
            reportData = generateServicesReport();
            break;
          case 'inventory':
            reportData = generateInventoryReport();
            break;
        }
        
        contentArea.innerHTML = reportData.html;
        
        // Scroll to preview
        previewArea.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }
      
      function generateRevenueReport() {
        const invoices = typeof getInvoices === 'function' ? getInvoices() : [];
        const startDate = new Date(document.getElementById('startDate').value);
        const endDate = new Date(document.getElementById('endDate').value);
        
        const filtered = invoices.filter(inv => {
          const invDate = new Date(inv.date || inv.createdAt);
          return invDate >= startDate && invDate <= endDate;
        });
        
        const total = filtered.reduce((sum, inv) => sum + (inv.total || 0), 0);
        const paid = filtered.filter(inv => inv.status === 'paid');
        const unpaid = filtered.filter(inv => inv.status !== 'paid');
        
        return {
          html: `
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
              <div style="padding: 20px; background: var(--gradient-primary); border-radius: 12px; color: white;">
                <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 8px;">Total Revenue</div>
                <div style="font-size: 2rem; font-weight: 800;">TSh ${total.toLocaleString()}</div>
                <div style="font-size: 0.75rem; opacity: 0.8; margin-top: 8px;">${filtered.length} invoices</div>
              </div>
              
              <div style="padding: 20px; background: var(--gradient-success); border-radius: 12px; color: white;">
                <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 8px;">Paid Invoices</div>
                <div style="font-size: 2rem; font-weight: 800;">${paid.length}</div>
                <div style="font-size: 0.75rem; opacity: 0.8; margin-top: 8px;">TSh ${paid.reduce((s,i)=>s+(i.total||0),0).toLocaleString()}</div>
              </div>
              
              <div style="padding: 20px; background: var(--gradient-warning); border-radius: 12px; color: white;">
                <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 8px;">Unpaid Invoices</div>
                <div style="font-size: 2rem; font-weight: 800;">${unpaid.length}</div>
                <div style="font-size: 0.75rem; opacity: 0.8; margin-top: 8px;">TSh ${unpaid.reduce((s,i)=>s+(i.total||0),0).toLocaleString()}</div>
              </div>
            </div>
          `
        };
      }
      
      function generateClientsReport() {
        const clients = typeof getClients === 'function' ? getClients() : [];
        
        return {
          html: `
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
              <div style="padding: 20px; background: var(--gradient-purple); border-radius: 12px; color: white;">
                <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 8px;">Total Clients</div>
                <div style="font-size: 2rem; font-weight: 800;">${clients.length}</div>
                <div style="font-size: 0.75rem; opacity: 0.8; margin-top: 8px;">Active customers</div>
              </div>
              
              <div style="padding: 20px; background: var(--gradient-primary); border-radius: 12px; color: white;">
                <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 8px;">New This Month</div>
                <div style="font-size: 2rem; font-weight: 800;">--</div>
                <div style="font-size: 0.75rem; opacity: 0.8; margin-top: 8px;">Coming soon</div>
              </div>
            </div>
          `
        };
      }
      
      function generateServicesReport() {
        const services = typeof getServices === 'function' ? getServices() : [];
        
        return {
          html: `
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 16px;">
              <div style="padding: 20px; background: var(--gradient-success); border-radius: 12px; color: white;">
                <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 8px;">Total Services</div>
                <div style="font-size: 2rem; font-weight: 800;">${services.length}</div>
                <div style="font-size: 0.75rem; opacity: 0.8; margin-top: 8px;">Available offerings</div>
              </div>
              
              <div style="padding: 20px; background: var(--gradient-primary); border-radius: 12px; color: white;">
                <div style="font-size: 0.875rem; opacity: 0.9; margin-bottom: 8px;">Most Popular</div>
                <div style="font-size: 1.25rem; font-weight: 800;">--</div>
                <div style="font-size: 0.75rem; opacity: 0.8; margin-top: 8px;">Coming soon</div>
              </div>
            </div>
          `
        };
      }
      
      function generateInventoryReport() {
        return {
          html: `
            <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
              <div style="font-size: 3rem; margin-bottom: 16px;">ðŸ“¦</div>
              <div style="font-size: 1.125rem; font-weight: 600; margin-bottom: 8px;">Inventory Tracking</div>
              <div style="font-size: 0.875rem;">This feature is coming soon</div>
            </div>
          `
        };
      }
      
      function setQuickRange(range) {
        const today = new Date();
        let startDate = new Date();
        
        switch(range) {
          case 'today':
            startDate = new Date(today);
            break;
          case 'week':
            startDate = new Date(today.setDate(today.getDate() - today.getDay()));
            break;
          case 'month':
            startDate = new Date(today.getFullYear(), today.getMonth(), 1);
            break;
          case 'quarter':
            const quarter = Math.floor(today.getMonth() / 3);
            startDate = new Date(today.getFullYear(), quarter * 3, 1);
            break;
          case 'year':
            startDate = new Date(today.getFullYear(), 0, 1);
            break;
        }
        
        document.getElementById('startDate').valueAsDate = startDate;
        document.getElementById('endDate').valueAsDate = new Date();
        
        if (currentReportType) {
          generateReport(currentReportType);
        }
      }
      
      function applyDateRange() {
        if (currentReportType) {
          generateReport(currentReportType);
        } else {
          alert('Please select a report type first');
        }
      }
      
      function exportReport(format) {
        if (!currentReportType) {
          alert('Please generate a report first');
          return;
        }
        
        alert(`Exporting ${currentReportType} report as ${format.toUpperCase()}...\n\nThis feature will be implemented soon!`);
      }
      
      // Add styles for quick range buttons
      const style = document.createElement('style');
      style.textContent = `
        .quick-range-btn {
          padding: 8px 16px;
          background: white;
          border: 1px solid var(--border);
          border-radius: 6px;
          font-size: 0.875rem;
          font-weight: 600;
          cursor: pointer;
          transition: var(--transition-base);
        }
        
        .quick-range-btn:hover {
          border-color: var(--primary);
          color: var(--primary);
          transform: translateY(-1px);
          box-shadow: var(--shadow-sm);
        }
      `;
      document.head.appendChild(style);
    </script>
  </body>
</html>
